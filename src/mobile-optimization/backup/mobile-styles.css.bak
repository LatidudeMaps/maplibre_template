/* ==========================================================================
   STILI SPECIFICI PER DISPOSITIVI MOBILI
   ========================================================================== */

/* Classe aggiunta al body quando si rileva un dispositivo mobile */
.mobile-device {
   --mobile-touch-area: 34px; /* Dimensione area di tocco */
   --mobile-control-size: 34px; /* Dimensione controlli */
   --mobile-primary-color: #0078FF;
   --mobile-text-color: rgba(0, 0, 0, 0.8);
   --mobile-border-color: rgba(0, 0, 0, 0.1);
   --mobile-background-color: white;
   --mobile-container-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
   --mobile-border-radius: 4px;
}

/* Applicazione di stili diversi per il tema scuro */
.dark.mobile-device {
   --mobile-text-color: rgba(255, 255, 255, 0.9);
   --mobile-border-color: rgba(255, 255, 255, 0.15);
   --mobile-background-color: #1e293b;
   --mobile-container-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

/* Layout orizzontale dei controlli principali */
.mobile-horizontal-controls .mobile-top-controls-container {
   background-color: transparent;
   z-index: 1000;
}

.mobile-horizontal-controls .mobile-controls-left,
.mobile-horizontal-controls .mobile-controls-center,
.mobile-horizontal-controls .mobile-controls-right {
   background-color: var(--mobile-background-color);
   border-radius: 20px;
   box-shadow: var(--mobile-container-shadow);
   overflow: hidden;
}

/* Stile per il pulsante logo */
.mobile-horizontal-controls .maplibregl-ctrl-logo-button {
   width: var(--mobile-control-size) !important;
   height: var(--mobile-control-size) !important;
   padding: 0 !important;
   margin: 0 !important;
   border-radius: 50% !important;
   background-color: var(--mobile-background-color) !important;
   box-shadow: var(--mobile-container-shadow) !important;
   display: flex !important;
   align-items: center !important;
   justify-content: center !important;
}

/* Stile per i controlli di navigazione centrali */
.mobile-horizontal-controls .mobile-controls-center .maplibregl-ctrl-group {
   margin: 0 !important;
   overflow: hidden !important;
   display: flex !important;
   flex-direction: row !important;
   align-items: center !important;
   justify-content: center !important;
}

.mobile-horizontal-controls .mobile-controls-center button {
   width: var(--mobile-control-size) !important;
   height: var(--mobile-control-size) !important;
   margin: 0 !important;
   padding: 0 !important;
   border: none !important;
   border-radius: 0 !important;
   display: flex !important;
   align-items: center !important;
   justify-content: center !important;
}

.mobile-horizontal-controls .mobile-controls-center button:not(:last-child) {
   border-right: 1px solid var(--mobile-border-color) !important;
}

/* Stile per il wrapper a destra */
.mobile-horizontal-controls .mobile-controls-right .maplibregl-ctrl-group {
   margin: 0 !important;
   overflow: hidden !important;
}

.mobile-horizontal-controls .mobile-controls-right button {
   width: var(--mobile-control-size) !important;
   height: var(--mobile-control-size) !important;
   margin: 0 !important;
   padding: 0 !important;
   display: flex !important;
   align-items: center !important;
   justify-content: center !important;
}

/* Stile per la tendina dei controlli */
.mobile-horizontal-controls .settings-controls-container {
   background-color: var(--mobile-background-color) !important;
   border-radius: var(--mobile-border-radius) !important;
   box-shadow: var(--mobile-container-shadow) !important;
   padding: 5px !important;
   margin: 0 !important;
   display: flex !important;
   flex-direction: column !important;
   gap: 5px !important;
   z-index: 1001 !important; /* Assicura che sia sopra tutti gli altri controlli */
}

.mobile-horizontal-controls .settings-controls-container button {
   width: var(--mobile-control-size) !important;
   height: var(--mobile-control-size) !important;
   margin: 0 !important;
   padding: 0 !important;
   border-radius: var(--mobile-border-radius) !important;
   display: flex !important;
   align-items: center !important;
   justify-content: center !important;
}

/* Stile per il selettore di basemap */
.mobile-horizontal-controls .basemap-buttons-control {
   background-color: var(--mobile-background-color) !important;
   border-radius: 20px !important;
   box-shadow: var(--mobile-container-shadow) !important;
   overflow: hidden !important;
}

.mobile-horizontal-controls .basemap-buttons-container {
   display: flex !important;
   flex-direction: row !important;
   gap: 0 !important;
}

.mobile-horizontal-controls .basemap-button {
   margin: 0 !important;
   padding: 6px 10px !important;
   font-size: 12px !important;
   border-radius: 0 !important;
   border: none !important;
   background-color: transparent !important;
   color: var(--mobile-text-color) !important;
}

.mobile-horizontal-controls .basemap-button.active {
   background-color: var(--mobile-primary-color) !important;
   color: white !important;
}

/* Nascondi la minimap su mobile */
.mobile-horizontal-controls .minimap-container,
.mobile-device .minimap-container {
   display: none !important;
}

/* Fix specifico per il Vector Layer Control */
.mobile-device .vector-layer-control {
   cursor: pointer !important;
   pointer-events: auto !important;
}

/* Migliora la visualizzazione dei popup e pannelli su mobile */
.mobile-device .maplibregl-popup {
   max-width: 85vw !important;
}

.mobile-device .maplibregl-popup-content {
   padding: 10px !important;
   font-size: 13px !important;
   line-height: 1.4 !important;
   max-height: 70vh !important;
   overflow-y: auto !important;
   background-color: var(--mobile-background-color) !important;
   color: var(--mobile-text-color) !important;
}

/* Aumenta la dimensione dell'area di tocco per chiudere un popup */
.mobile-device .maplibregl-popup-close-button {
   padding: 5px !important;
   font-size: 18px !important;
   top: 2px !important;
   right: 2px !important;
   color: var(--mobile-text-color) !important;
}

/* Miglioramenti per i controlli dei layer vettoriali */
.mobile-device .vector-layer-panel {
   box-shadow: var(--mobile-container-shadow) !important;
   border-radius: 6px !important;
   background-color: var(--mobile-background-color) !important;
   color: var(--mobile-text-color) !important;
   z-index: 999 !important;
}

.mobile-device .vector-layer-panel-header {
   padding: 8px 10px !important;
   display: flex !important;
   align-items: center !important;
   justify-content: space-between !important;
   border-bottom: 1px solid var(--mobile-border-color) !important;
}

.mobile-device .vector-layer-panel-title {
   font-size: 14px !important;
   font-weight: 600 !important;
   margin: 0 !important;
}

.mobile-device .vector-layer-panel-item {
   padding: 8px 10px !important;
   border-top: 1px solid var(--mobile-border-color) !important;
   display: flex !important;
   align-items: center !important;
   justify-content: space-between !important;
}

.mobile-device .vector-layer-panel-remove {
   width: 26px !important;
   height: 26px !important;
   line-height: 26px !important;
   text-align: center !important;
   font-size: 16px !important;
   display: flex !important;
   align-items: center !important;
   justify-content: center !important;
   border-radius: 3px !important;
   margin-left: 5px !important;
}

.mobile-device .vector-layer-panel-item label {
   font-size: 13px !important;
   overflow: hidden !important;
   text-overflow: ellipsis !important;
   white-space: nowrap !important;
   max-width: calc(100% - 35px) !important;
   line-height: 1.2 !important;
}

/* Stili per i dialoghi */
.mobile-device .vector-layer-dialog {
   box-shadow: var(--mobile-container-shadow) !important;
   border-radius: 8px !important;
   background-color: var(--mobile-background-color) !important;
   color: var(--mobile-text-color) !important;
   z-index: 1002 !important; /* Sopra tutti gli altri elementi */
}

.mobile-device .vector-layer-dialog h3,
.mobile-device .vector-layer-dialog h4 {
   font-size: 16px !important;
   font-weight: 600 !important;
   margin: 0 0 12px 0 !important;
   padding: 0 !important;
}

.mobile-device .vector-layer-dialog input, 
.mobile-device .vector-layer-dialog select,
.mobile-device .vector-layer-dialog button {
   height: 36px !important;
   font-size: 15px !important; /* Previeni lo zoom automatico su iOS */
   border-radius: 4px !important;
   border: 1px solid var(--mobile-border-color) !important;
}

.mobile-device .vector-layer-dialog input,
.mobile-device .vector-layer-dialog select {
   width: 100% !important;
   padding: 5px 8px !important;
   margin-bottom: 10px !important;
   box-sizing: border-box !important;
}

.mobile-device .vector-layer-dialog-buttons,
.mobile-device .buttons-container {
   display: flex !important;
   justify-content: center !important;
   margin-top: 15px !important;
   gap: 10px !important;
}

.mobile-device .vector-layer-dialog button {
   padding: 0 15px !important;
   background-color: var(--mobile-primary-color) !important;
   color: white !important;
   border: none !important;
}

.mobile-device .vector-layer-dialog button.cancel-button {
   background-color: transparent !important;
   color: var(--mobile-text-color) !important;
   border: 1px solid var(--mobile-border-color) !important;
}

/* Gestisci le informazioni di coordinate in modo più compatto */
.mobile-device .map-info-panel {
   padding: 10px !important;
   font-size: 12px !important;
   background-color: var(--mobile-background-color) !important;
   color: var(--mobile-text-color) !important;
   box-shadow: var(--mobile-container-shadow) !important;
   border-radius: 6px !important;
   line-height: 1.3 !important;
   z-index: 998 !important;
}

.mobile-device .map-info-panel table {
   width: 100% !important;
   border-collapse: collapse !important;
}

.mobile-device .map-info-panel td {
   padding: 3px 5px !important;
   vertical-align: top !important;
}

.mobile-device .coord-label {
   font-size: 12px !important;
   font-weight: 600 !important;
   margin-right: 5px !important;
}

.mobile-device .coord-value {
   font-size: 11px !important;
   font-family: monospace !important;
   overflow: hidden !important;
   text-overflow: ellipsis !important;
   max-width: 100px !important;
   display: inline-block !important;
}

/* Evidenziazione al tocco per i controlli */
.mobile-touch-active {
   background-color: rgba(0, 120, 255, 0.15) !important;
   position: relative;
   overflow: hidden;
}

/* Effetto ripple (onda) al tocco */
.mobile-touch-ripple {
   position: absolute;
   background: radial-gradient(circle, rgba(255, 255, 255, 0.7) 0%, rgba(255, 255, 255, 0) 70%);
   transform: scale(0);
   border-radius: 50%;
   pointer-events: none;
   width: 100px;
   height: 100px;
   top: calc(50% - 50px);
   left: calc(50% - 50px);
   animation: mobile-ripple 0.5s ease-out forwards;
}

.dark .mobile-touch-ripple {
   background: radial-gradient(circle, rgba(255, 255, 255, 0.3) 0%, rgba(255, 255, 255, 0) 70%);
}

@keyframes mobile-ripple {
   to {
       transform: scale(2.5);
       opacity: 0;
   }
}

/* Stili per l'informazione sulle gesture */
.mobile-gesture-info {
   position: fixed;
   bottom: 20px;
   left: 50%;
   transform: translateX(-50%);
   width: 80%;
   max-width: 280px;
   background: rgba(255, 255, 255, 0.95);
   border-radius: 8px;
   box-shadow: 0 3px 15px rgba(0, 0, 0, 0.15);
   z-index: 1000;
   animation: slide-up 0.3s ease-out forwards;
}

.dark .mobile-gesture-info {
   background: rgba(30, 41, 59, 0.95);
   color: white;
}

.mobile-gesture-info-content {
   padding: 12px;
}

.mobile-gesture-info h3 {
   margin: 0 0 8px 0;
   font-size: 15px;
   text-align: center;
}

.mobile-gesture-list {
   list-style: none;
   padding: 0;
   margin: 0;
}

.mobile-gesture-list li {
   display: flex;
   align-items: center;
   padding: 6px 0;
   border-bottom: 1px solid rgba(0, 0, 0, 0.1);
   font-size: 13px;
}

.dark .mobile-gesture-list li {
   border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.mobile-gesture-list li:last-child {
   border-bottom: none;
}

.gesture-icon {
   display: inline-block;
   width: 30px;
   margin-right: 8px;
   font-size: 16px;
}

.mobile-gesture-close {
   display: block;
   width: 100%;
   margin-top: 10px;
   padding: 8px;
   background: var(--mobile-primary-color);
   color: white;
   border: none;
   border-radius: 6px;
   font-size: 13px;
   font-weight: 500;
   cursor: pointer;
}

/* Animazioni */
@keyframes slide-up {
   from {
       transform: translate(-50%, 50px);
       opacity: 0;
   }
   to {
       transform: translate(-50%, 0);
       opacity: 1;
   }
}

/* Personalizzazioni per diverse dimensioni di schermo */
@media (max-width: 480px) {
   .mobile-horizontal-controls .mobile-top-controls-container {
       padding: 0 3px !important;
   }
   
   .mobile-horizontal-controls .settings-controls-container {
       right: 3px !important;
   }
   
   .mobile-device .maplibregl-ctrl-scale {
       margin: 0 0 2px 2px !important;
       width: 80px !important;
   }
   
   .mobile-device .basemap-button {
       padding: 6px 8px !important;
       font-size: 11px !important;
   }
}

/* Aggiustamenti per orientamento landscape su schermi piccoli */
@media (max-height: 450px) and (orientation: landscape) {
   .mobile-horizontal-controls .mobile-top-controls-container {
       top: 3px !important;
   }
   
   .mobile-horizontal-controls .settings-controls-container {
       top: 40px !important;
   }
   
   .mobile-device .map-info-panel {
       bottom: 50px !important;
       max-height: 120px !important;
       overflow-y: auto !important;
   }
   
   .mobile-device .basemap-buttons-control {
       bottom: 20px !important;
   }
}

/* Per assicurare che i controlli rimangano sulla mappa */
.maplibregl-control-container {
   pointer-events: none;
}

.maplibregl-control-container .maplibregl-ctrl {
   pointer-events: auto;
}

/* Fix per il Vector Layer Control nella tendina */
.settings-controls-container .vector-layer-control {
   pointer-events: auto !important;
   cursor: pointer !important;
}

/* Nascondi i controlli originali ma mantieni funzionalità */
.mobile-horizontal-controls .maplibregl-ctrl-top-left,
.mobile-horizontal-controls .maplibregl-ctrl-top-right {
   opacity: 0 !important;
   position: absolute !important;
   z-index: -1 !important; 
   visibility: hidden !important;
}

/* Permetti eventi sui controlli nascosti ma non mostrarli visivamente */
.mobile-horizontal-controls .maplibregl-ctrl {
   pointer-events: auto !important;
}